import re
import csv

# Paste your training log here as a multiline string
training_log = """
Epoch 1/100 | Train Loss: 1.8718 | Train Acc: 0.3773 | Test Loss: 1.1418 | Test Acc: 0.6500
Epoch 2/100 | Train Loss: 1.2384 | Train Acc: 0.5865 | Test Loss: 0.9470 | Test Acc: 0.6750
Epoch 3/100 | Train Loss: 1.0868 | Train Acc: 0.6510 | Test Loss: 0.9788 | Test Acc: 0.6550
Epoch 4/100 | Train Loss: 1.0463 | Train Acc: 0.6562 | Test Loss: 0.7593 | Test Acc: 0.7350
Epoch 5/100 | Train Loss: 0.9152 | Train Acc: 0.6900 | Test Loss: 0.7191 | Test Acc: 0.7500
Epoch 6/100 | Train Loss: 0.8852 | Train Acc: 0.6988 | Test Loss: 0.7291 | Test Acc: 0.7500
Epoch 7/100 | Train Loss: 0.8084 | Train Acc: 0.7256 | Test Loss: 0.6914 | Test Acc: 0.7500
Epoch 8/100 | Train Loss: 0.6993 | Train Acc: 0.7668 | Test Loss: 0.6481 | Test Acc: 0.7850
Epoch 9/100 | Train Loss: 0.6875 | Train Acc: 0.7719 | Test Loss: 0.5971 | Test Acc: 0.8050
Epoch 10/100 | Train Loss: 0.6604 | Train Acc: 0.7881 | Test Loss: 0.5600 | Test Acc: 0.7900
Epoch 11/100 | Train Loss: 0.6287 | Train Acc: 0.7881 | Test Loss: 0.4858 | Test Acc: 0.8500
Epoch 12/100 | Train Loss: 0.5879 | Train Acc: 0.7969 | Test Loss: 0.4315 | Test Acc: 0.8850
Epoch 13/100 | Train Loss: 0.5639 | Train Acc: 0.7986 | Test Loss: 0.5532 | Test Acc: 0.8100
Epoch 14/100 | Train Loss: 0.5709 | Train Acc: 0.8018 | Test Loss: 0.5165 | Test Acc: 0.8350
Epoch 15/100 | Train Loss: 0.5289 | Train Acc: 0.8139 | Test Loss: 0.4705 | Test Acc: 0.8500
Epoch 16/100 | Train Loss: 0.5311 | Train Acc: 0.8189 | Test Loss: 0.4149 | Test Acc: 0.8600
Epoch 17/100 | Train Loss: 0.5089 | Train Acc: 0.8176 | Test Loss: 0.3635 | Test Acc: 0.8850
Epoch 18/100 | Train Loss: 0.5072 | Train Acc: 0.8164 | Test Loss: 0.3763 | Test Acc: 0.8950
Epoch 19/100 | Train Loss: 0.4375 | Train Acc: 0.8420 | Test Loss: 0.3956 | Test Acc: 0.8500
Epoch 20/100 | Train Loss: 0.4811 | Train Acc: 0.8359 | Test Loss: 0.4804 | Test Acc: 0.8350
Epoch 21/100 | Train Loss: 0.4847 | Train Acc: 0.8359 | Test Loss: 0.3888 | Test Acc: 0.8800
Epoch 22/100 | Train Loss: 0.4446 | Train Acc: 0.8598 | Test Loss: 0.3958 | Test Acc: 0.8600
Epoch 23/100 | Train Loss: 0.4314 | Train Acc: 0.8373 | Test Loss: 0.4286 | Test Acc: 0.8300
Epoch 24/100 | Train Loss: 0.4190 | Train Acc: 0.8518 | Test Loss: 0.3958 | Test Acc: 0.8300
Epoch 25/100 | Train Loss: 0.3808 | Train Acc: 0.8641 | Test Loss: 0.4412 | Test Acc: 0.8300
Epoch 26/100 | Train Loss: 0.3867 | Train Acc: 0.8631 | Test Loss: 0.4724 | Test Acc: 0.8350
Epoch 27/100 | Train Loss: 0.3488 | Train Acc: 0.8668 | Test Loss: 0.3480 | Test Acc: 0.8550
Epoch 28/100 | Train Loss: 0.3741 | Train Acc: 0.8672 | Test Loss: 0.3115 | Test Acc: 0.8850
Epoch 29/100 | Train Loss: 0.3735 | Train Acc: 0.8672 | Test Loss: 0.3978 | Test Acc: 0.8650
Epoch 30/100 | Train Loss: 0.3902 | Train Acc: 0.8748 | Test Loss: 0.3084 | Test Acc: 0.8900
Epoch 31/100 | Train Loss: 0.3565 | Train Acc: 0.8803 | Test Loss: 0.3023 | Test Acc: 0.8900
Epoch 32/100 | Train Loss: 0.3490 | Train Acc: 0.8816 | Test Loss: 0.3707 | Test Acc: 0.8550
Epoch 33/100 | Train Loss: 0.3710 | Train Acc: 0.8723 | Test Loss: 0.3082 | Test Acc: 0.9050
Epoch 34/100 | Train Loss: 0.3664 | Train Acc: 0.8734 | Test Loss: 0.3505 | Test Acc: 0.8650
Epoch 35/100 | Train Loss: 0.3642 | Train Acc: 0.8742 | Test Loss: 0.3118 | Test Acc: 0.8950
Epoch 36/100 | Train Loss: 0.3437 | Train Acc: 0.8809 | Test Loss: 0.3180 | Test Acc: 0.8850
Epoch 37/100 | Train Loss: 0.3180 | Train Acc: 0.8852 | Test Loss: 0.3448 | Test Acc: 0.8800
Epoch 38/100 | Train Loss: 0.3271 | Train Acc: 0.8883 | Test Loss: 0.3718 | Test Acc: 0.8700
Epoch 39/100 | Train Loss: 0.3003 | Train Acc: 0.8979 | Test Loss: 0.3454 | Test Acc: 0.8600
Epoch 40/100 | Train Loss: 0.3050 | Train Acc: 0.8898 | Test Loss: 0.3952 | Test Acc: 0.8450
Epoch 41/100 | Train Loss: 0.3210 | Train Acc: 0.8928 | Test Loss: 0.2968 | Test Acc: 0.8900
Epoch 42/100 | Train Loss: 0.3069 | Train Acc: 0.9002 | Test Loss: 0.3032 | Test Acc: 0.8900
Epoch 43/100 | Train Loss: 0.3153 | Train Acc: 0.8908 | Test Loss: 0.3658 | Test Acc: 0.8800
Epoch 44/100 | Train Loss: 0.3009 | Train Acc: 0.8871 | Test Loss: 0.3059 | Test Acc: 0.8900
Epoch 45/100 | Train Loss: 0.2745 | Train Acc: 0.9182 | Test Loss: 0.2915 | Test Acc: 0.8850
Epoch 46/100 | Train Loss: 0.2796 | Train Acc: 0.9113 | Test Loss: 0.3151 | Test Acc: 0.8850
Epoch 47/100 | Train Loss: 0.2932 | Train Acc: 0.9041 | Test Loss: 0.2911 | Test Acc: 0.8850
Epoch 48/100 | Train Loss: 0.2831 | Train Acc: 0.9016 | Test Loss: 0.2926 | Test Acc: 0.8650
Epoch 49/100 | Train Loss: 0.2696 | Train Acc: 0.9072 | Test Loss: 0.3021 | Test Acc: 0.8850
Epoch 50/100 | Train Loss: 0.2735 | Train Acc: 0.9006 | Test Loss: 0.3215 | Test Acc: 0.8600
Epoch 51/100 | Train Loss: 0.2782 | Train Acc: 0.9004 | Test Loss: 0.2741 | Test Acc: 0.8950
Epoch 52/100 | Train Loss: 0.2685 | Train Acc: 0.9049 | Test Loss: 0.2601 | Test Acc: 0.9000
Epoch 53/100 | Train Loss: 0.2853 | Train Acc: 0.8998 | Test Loss: 0.2587 | Test Acc: 0.8900
Epoch 54/100 | Train Loss: 0.2532 | Train Acc: 0.9090 | Test Loss: 0.2420 | Test Acc: 0.9150
Epoch 55/100 | Train Loss: 0.2797 | Train Acc: 0.9031 | Test Loss: 0.2351 | Test Acc: 0.9100
Epoch 56/100 | Train Loss: 0.2553 | Train Acc: 0.9100 | Test Loss: 0.2881 | Test Acc: 0.8950
Epoch 57/100 | Train Loss: 0.2187 | Train Acc: 0.9193 | Test Loss: 0.2675 | Test Acc: 0.8850
Epoch 58/100 | Train Loss: 0.2692 | Train Acc: 0.9096 | Test Loss: 0.2690 | Test Acc: 0.8950
Epoch 59/100 | Train Loss: 0.2343 | Train Acc: 0.9131 | Test Loss: 0.2583 | Test Acc: 0.8950
Epoch 60/100 | Train Loss: 0.2507 | Train Acc: 0.9178 | Test Loss: 0.2459 | Test Acc: 0.9000
Epoch 61/100 | Train Loss: 0.2192 | Train Acc: 0.9305 | Test Loss: 0.2362 | Test Acc: 0.8950
Epoch 62/100 | Train Loss: 0.2282 | Train Acc: 0.9182 | Test Loss: 0.2737 | Test Acc: 0.8900
Epoch 63/100 | Train Loss: 0.2354 | Train Acc: 0.9205 | Test Loss: 0.2768 | Test Acc: 0.8800
Epoch 64/100 | Train Loss: 0.2611 | Train Acc: 0.9033 | Test Loss: 0.2559 | Test Acc: 0.9000
Epoch 65/100 | Train Loss: 0.2472 | Train Acc: 0.9078 | Test Loss: 0.2565 | Test Acc: 0.8850
Epoch 66/100 | Train Loss: 0.2336 | Train Acc: 0.9166 | Test Loss: 0.2430 | Test Acc: 0.9000
Epoch 67/100 | Train Loss: 0.2380 | Train Acc: 0.9227 | Test Loss: 0.2721 | Test Acc: 0.8750
Epoch 68/100 | Train Loss: 0.2402 | Train Acc: 0.9193 | Test Loss: 0.2735 | Test Acc: 0.8900
Epoch 69/100 | Train Loss: 0.2370 | Train Acc: 0.9203 | Test Loss: 0.2419 | Test Acc: 0.9000
Epoch 70/100 | Train Loss: 0.2170 | Train Acc: 0.9172 | Test Loss: 0.2509 | Test Acc: 0.8850
Epoch 71/100 | Train Loss: 0.2339 | Train Acc: 0.9230 | Test Loss: 0.2600 | Test Acc: 0.9050
Epoch 72/100 | Train Loss: 0.2390 | Train Acc: 0.9191 | Test Loss: 0.2536 | Test Acc: 0.9050
Epoch 73/100 | Train Loss: 0.1992 | Train Acc: 0.9318 | Test Loss: 0.2256 | Test Acc: 0.9150
Epoch 74/100 | Train Loss: 0.2094 | Train Acc: 0.9379 | Test Loss: 0.2663 | Test Acc: 0.8850
Epoch 75/100 | Train Loss: 0.1787 | Train Acc: 0.9367 | Test Loss: 0.2436 | Test Acc: 0.9050
Epoch 76/100 | Train Loss: 0.1856 | Train Acc: 0.9457 | Test Loss: 0.2321 | Test Acc: 0.9100
Epoch 77/100 | Train Loss: 0.2038 | Train Acc: 0.9301 | Test Loss: 0.2360 | Test Acc: 0.8950
Epoch 78/100 | Train Loss: 0.2035 | Train Acc: 0.9314 | Test Loss: 0.2426 | Test Acc: 0.8950
Epoch 79/100 | Train Loss: 0.2224 | Train Acc: 0.9289 | Test Loss: 0.2359 | Test Acc: 0.9000
Epoch 80/100 | Train Loss: 0.1929 | Train Acc: 0.9391 | Test Loss: 0.2296 | Test Acc: 0.9100
Epoch 81/100 | Train Loss: 0.1920 | Train Acc: 0.9363 | Test Loss: 0.2467 | Test Acc: 0.8900
Epoch 82/100 | Train Loss: 0.2036 | Train Acc: 0.9221 | Test Loss: 0.2321 | Test Acc: 0.8950
Epoch 83/100 | Train Loss: 0.2000 | Train Acc: 0.9387 | Test Loss: 0.2266 | Test Acc: 0.9100
Epoch 84/100 | Train Loss: 0.2093 | Train Acc: 0.9344 | Test Loss: 0.2356 | Test Acc: 0.9000
Epoch 85/100 | Train Loss: 0.2103 | Train Acc: 0.9344 | Test Loss: 0.2334 | Test Acc: 0.9050
Epoch 86/100 | Train Loss: 0.1906 | Train Acc: 0.9348 | Test Loss: 0.2353 | Test Acc: 0.8900
Epoch 87/100 | Train Loss: 0.1905 | Train Acc: 0.9393 | Test Loss: 0.2393 | Test Acc: 0.9000
Epoch 88/100 | Train Loss: 0.1919 | Train Acc: 0.9389 | Test Loss: 0.2392 | Test Acc: 0.8950
Epoch 89/100 | Train Loss: 0.1866 | Train Acc: 0.9359 | Test Loss: 0.2382 | Test Acc: 0.9000
Epoch 90/100 | Train Loss: 0.1884 | Train Acc: 0.9338 | Test Loss: 0.2345 | Test Acc: 0.9000
Epoch 91/100 | Train Loss: 0.1804 | Train Acc: 0.9480 | Test Loss: 0.2314 | Test Acc: 0.9000
Epoch 92/100 | Train Loss: 0.1723 | Train Acc: 0.9441 | Test Loss: 0.2309 | Test Acc: 0.9000
Epoch 93/100 | Train Loss: 0.2077 | Train Acc: 0.9344 | Test Loss: 0.2315 | Test Acc: 0.8950
Epoch 94/100 | Train Loss: 0.1679 | Train Acc: 0.9428 | Test Loss: 0.2312 | Test Acc: 0.9050
Epoch 95/100 | Train Loss: 0.2008 | Train Acc: 0.9396 | Test Loss: 0.2325 | Test Acc: 0.9050
Epoch 96/100 | Train Loss: 0.2141 | Train Acc: 0.9332 | Test Loss: 0.2327 | Test Acc: 0.9050
Epoch 97/100 | Train Loss: 0.1796 | Train Acc: 0.9354 | Test Loss: 0.2323 | Test Acc: 0.9050
Epoch 98/100 | Train Loss: 0.1805 | Train Acc: 0.9406 | Test Loss: 0.2320 | Test Acc: 0.9050
Epoch 99/100 | Train Loss: 0.1729 | Train Acc: 0.9469 | Test Loss: 0.2317 | Test Acc: 0.9050
Epoch 100/100 | Train Loss: 0.1756 | Train Acc: 0.9357 | Test Loss: 0.2317 | Test Acc: 0.9050
Training completed in 359.87 seconds for n_train=1000 (MNIST)
=== Starting training for MNIST: train size 2000, batch size 64, epochs 100 ===

Starting repetition 1/1 for train size 2000, batch size 64 (MNIST)
Total number of parameters in the QViT model for MNIST: 69,111
Epoch 1/100 | Train Loss: 1.6989 | Train Acc: 0.4219 | Test Loss: 0.9455 | Test Acc: 0.6825
Epoch 2/100 | Train Loss: 1.1185 | Train Acc: 0.6250 | Test Loss: 0.7410 | Test Acc: 0.7600
Epoch 3/100 | Train Loss: 0.9525 | Train Acc: 0.6743 | Test Loss: 0.6332 | Test Acc: 0.7900
Epoch 4/100 | Train Loss: 0.8246 | Train Acc: 0.7407 | Test Loss: 0.5550 | Test Acc: 0.8375
Epoch 5/100 | Train Loss: 0.7426 | Train Acc: 0.7583 | Test Loss: 0.4867 | Test Acc: 0.8500
Epoch 6/100 | Train Loss: 0.6215 | Train Acc: 0.7988 | Test Loss: 0.4429 | Test Acc: 0.8725
Epoch 7/100 | Train Loss: 0.6218 | Train Acc: 0.7822 | Test Loss: 0.5113 | Test Acc: 0.8250
Epoch 8/100 | Train Loss: 0.5696 | Train Acc: 0.8042 | Test Loss: 0.3870 | Test Acc: 0.8900
Epoch 9/100 | Train Loss: 0.5253 | Train Acc: 0.8213 | Test Loss: 0.3642 | Test Acc: 0.8800
Epoch 10/100 | Train Loss: 0.4755 | Train Acc: 0.8325 | Test Loss: 0.4064 | Test Acc: 0.8700
Epoch 11/100 | Train Loss: 0.5045 | Train Acc: 0.8311 | Test Loss: 0.4245 | Test Acc: 0.8325
Epoch 12/100 | Train Loss: 0.4582 | Train Acc: 0.8442 | Test Loss: 0.3905 | Test Acc: 0.8750
Epoch 13/100 | Train Loss: 0.4636 | Train Acc: 0.8364 | Test Loss: 0.3996 | Test Acc: 0.8800
Epoch 14/100 | Train Loss: 0.4513 | Train Acc: 0.8462 | Test Loss: 0.3409 | Test Acc: 0.9050
Epoch 15/100 | Train Loss: 0.4235 | Train Acc: 0.8628 | Test Loss: 0.3311 | Test Acc: 0.8900
Epoch 16/100 | Train Loss: 0.4121 | Train Acc: 0.8521 | Test Loss: 0.3102 | Test Acc: 0.8975
Epoch 17/100 | Train Loss: 0.4226 | Train Acc: 0.8550 | Test Loss: 0.3573 | Test Acc: 0.8725
Epoch 18/100 | Train Loss: 0.4011 | Train Acc: 0.8628 | Test Loss: 0.3352 | Test Acc: 0.8800
Epoch 19/100 | Train Loss: 0.3996 | Train Acc: 0.8633 | Test Loss: 0.3751 | Test Acc: 0.8825
Epoch 20/100 | Train Loss: 0.3971 | Train Acc: 0.8618 | Test Loss: 0.3103 | Test Acc: 0.8750
Epoch 21/100 | Train Loss: 0.3822 | Train Acc: 0.8745 | Test Loss: 0.2936 | Test Acc: 0.9050
Epoch 22/100 | Train Loss: 0.3555 | Train Acc: 0.8789 | Test Loss: 0.3020 | Test Acc: 0.8875
Epoch 23/100 | Train Loss: 0.3475 | Train Acc: 0.8838 | Test Loss: 0.3297 | Test Acc: 0.8900
Epoch 24/100 | Train Loss: 0.3650 | Train Acc: 0.8853 | Test Loss: 0.3134 | Test Acc: 0.8800
Epoch 25/100 | Train Loss: 0.3349 | Train Acc: 0.8779 | Test Loss: 0.3337 | Test Acc: 0.8975
Epoch 26/100 | Train Loss: 0.3476 | Train Acc: 0.8828 | Test Loss: 0.3082 | Test Acc: 0.9025
Epoch 27/100 | Train Loss: 0.3094 | Train Acc: 0.8950 | Test Loss: 0.2715 | Test Acc: 0.8975
Epoch 28/100 | Train Loss: 0.3259 | Train Acc: 0.8882 | Test Loss: 0.2970 | Test Acc: 0.8975
Epoch 29/100 | Train Loss: 0.3270 | Train Acc: 0.8853 | Test Loss: 0.2735 | Test Acc: 0.9125
Epoch 30/100 | Train Loss: 0.2893 | Train Acc: 0.9033 | Test Loss: 0.2374 | Test Acc: 0.9175
Epoch 31/100 | Train Loss: 0.2758 | Train Acc: 0.9028 | Test Loss: 0.2659 | Test Acc: 0.9125
Epoch 32/100 | Train Loss: 0.3042 | Train Acc: 0.8882 | Test Loss: 0.2445 | Test Acc: 0.9175
Epoch 33/100 | Train Loss: 0.3103 | Train Acc: 0.8911 | Test Loss: 0.2610 | Test Acc: 0.9075
Epoch 34/100 | Train Loss: 0.3236 | Train Acc: 0.8877 | Test Loss: 0.2511 | Test Acc: 0.9200
Epoch 35/100 | Train Loss: 0.2831 | Train Acc: 0.8989 | Test Loss: 0.2841 | Test Acc: 0.8975
Epoch 36/100 | Train Loss: 0.2996 | Train Acc: 0.8984 | Test Loss: 0.2474 | Test Acc: 0.9150
Epoch 37/100 | Train Loss: 0.3042 | Train Acc: 0.8955 | Test Loss: 0.2608 | Test Acc: 0.9150
Epoch 38/100 | Train Loss: 0.2903 | Train Acc: 0.8970 | Test Loss: 0.2148 | Test Acc: 0.9250
Epoch 39/100 | Train Loss: 0.2751 | Train Acc: 0.9092 | Test Loss: 0.2553 | Test Acc: 0.9050
Epoch 40/100 | Train Loss: 0.2838 | Train Acc: 0.9014 | Test Loss: 0.2711 | Test Acc: 0.9075
Epoch 41/100 | Train Loss: 0.2697 | Train Acc: 0.9116 | Test Loss: 0.2584 | Test Acc: 0.9050
Epoch 42/100 | Train Loss: 0.2582 | Train Acc: 0.9121 | Test Loss: 0.2410 | Test Acc: 0.9125
Epoch 43/100 | Train Loss: 0.2419 | Train Acc: 0.9155 | Test Loss: 0.2272 | Test Acc: 0.9125
Epoch 44/100 | Train Loss: 0.2409 | Train Acc: 0.9204 | Test Loss: 0.2318 | Test Acc: 0.9200
Epoch 45/100 | Train Loss: 0.2467 | Train Acc: 0.9111 | Test Loss: 0.2209 | Test Acc: 0.9300
Epoch 46/100 | Train Loss: 0.2462 | Train Acc: 0.9111 | Test Loss: 0.2401 | Test Acc: 0.9350
Epoch 47/100 | Train Loss: 0.2587 | Train Acc: 0.9048 | Test Loss: 0.2471 | Test Acc: 0.9225
Epoch 48/100 | Train Loss: 0.2463 | Train Acc: 0.9077 | Test Loss: 0.2402 | Test Acc: 0.9200
Epoch 49/100 | Train Loss: 0.2321 | Train Acc: 0.9224 | Test Loss: 0.2354 | Test Acc: 0.9175
Epoch 50/100 | Train Loss: 0.2447 | Train Acc: 0.9146 | Test Loss: 0.2023 | Test Acc: 0.9300
Epoch 51/100 | Train Loss: 0.2259 | Train Acc: 0.9199 | Test Loss: 0.2266 | Test Acc: 0.9225
Epoch 52/100 | Train Loss: 0.2412 | Train Acc: 0.9121 | Test Loss: 0.2344 | Test Acc: 0.9125
Epoch 53/100 | Train Loss: 0.2324 | Train Acc: 0.9189 | Test Loss: 0.2195 | Test Acc: 0.9375
Epoch 54/100 | Train Loss: 0.2409 | Train Acc: 0.9204 | Test Loss: 0.2178 | Test Acc: 0.9250
Epoch 55/100 | Train Loss: 0.2447 | Train Acc: 0.9160 | Test Loss: 0.2328 | Test Acc: 0.9150
Epoch 56/100 | Train Loss: 0.1956 | Train Acc: 0.9316 | Test Loss: 0.2324 | Test Acc: 0.9250
Epoch 57/100 | Train Loss: 0.2273 | Train Acc: 0.9155 | Test Loss: 0.2116 | Test Acc: 0.9325
Epoch 58/100 | Train Loss: 0.2182 | Train Acc: 0.9194 | Test Loss: 0.1998 | Test Acc: 0.9325
Epoch 59/100 | Train Loss: 0.2052 | Train Acc: 0.9282 | Test Loss: 0.2127 | Test Acc: 0.9250
Epoch 60/100 | Train Loss: 0.2427 | Train Acc: 0.9209 | Test Loss: 0.2301 | Test Acc: 0.9200
Epoch 61/100 | Train Loss: 0.2049 | Train Acc: 0.9292 | Test Loss: 0.2211 | Test Acc: 0.9250
Epoch 62/100 | Train Loss: 0.2020 | Train Acc: 0.9277 | Test Loss: 0.2098 | Test Acc: 0.9325
Epoch 63/100 | Train Loss: 0.2022 | Train Acc: 0.9297 | Test Loss: 0.2209 | Test Acc: 0.9250
Epoch 64/100 | Train Loss: 0.2176 | Train Acc: 0.9219 | Test Loss: 0.2265 | Test Acc: 0.9250
Epoch 65/100 | Train Loss: 0.1942 | Train Acc: 0.9316 | Test Loss: 0.2105 | Test Acc: 0.9250
Epoch 66/100 | Train Loss: 0.1760 | Train Acc: 0.9395 | Test Loss: 0.2062 | Test Acc: 0.9250
Epoch 67/100 | Train Loss: 0.2042 | Train Acc: 0.9297 | Test Loss: 0.2076 | Test Acc: 0.9200
Epoch 68/100 | Train Loss: 0.2121 | Train Acc: 0.9229 | Test Loss: 0.2206 | Test Acc: 0.9200
Epoch 69/100 | Train Loss: 0.2034 | Train Acc: 0.9272 | Test Loss: 0.2025 | Test Acc: 0.9250
Epoch 70/100 | Train Loss: 0.1880 | Train Acc: 0.9312 | Test Loss: 0.1990 | Test Acc: 0.9300
Epoch 71/100 | Train Loss: 0.1816 | Train Acc: 0.9355 | Test Loss: 0.2071 | Test Acc: 0.9250
Epoch 72/100 | Train Loss: 0.1893 | Train Acc: 0.9287 | Test Loss: 0.2026 | Test Acc: 0.9300
Epoch 73/100 | Train Loss: 0.1940 | Train Acc: 0.9360 | Test Loss: 0.1982 | Test Acc: 0.9375
Epoch 74/100 | Train Loss: 0.1707 | Train Acc: 0.9443 | Test Loss: 0.1927 | Test Acc: 0.9300
Epoch 75/100 | Train Loss: 0.1771 | Train Acc: 0.9395 | Test Loss: 0.2001 | Test Acc: 0.9400
Epoch 76/100 | Train Loss: 0.1742 | Train Acc: 0.9414 | Test Loss: 0.1939 | Test Acc: 0.9325
Epoch 77/100 | Train Loss: 0.1781 | Train Acc: 0.9463 | Test Loss: 0.1999 | Test Acc: 0.9350
Epoch 78/100 | Train Loss: 0.1848 | Train Acc: 0.9414 | Test Loss: 0.1902 | Test Acc: 0.9375
Epoch 79/100 | Train Loss: 0.1731 | Train Acc: 0.9365 | Test Loss: 0.1934 | Test Acc: 0.9300
Epoch 80/100 | Train Loss: 0.1771 | Train Acc: 0.9414 | Test Loss: 0.1998 | Test Acc: 0.9375
Epoch 81/100 | Train Loss: 0.1573 | Train Acc: 0.9463 | Test Loss: 0.1835 | Test Acc: 0.9325
Epoch 82/100 | Train Loss: 0.1805 | Train Acc: 0.9360 | Test Loss: 0.1917 | Test Acc: 0.9300
Epoch 83/100 | Train Loss: 0.1880 | Train Acc: 0.9321 | Test Loss: 0.1866 | Test Acc: 0.9350
Epoch 84/100 | Train Loss: 0.1653 | Train Acc: 0.9429 | Test Loss: 0.1905 | Test Acc: 0.9375
Epoch 85/100 | Train Loss: 0.1690 | Train Acc: 0.9424 | Test Loss: 0.1879 | Test Acc: 0.9400
Epoch 86/100 | Train Loss: 0.1725 | Train Acc: 0.9404 | Test Loss: 0.1914 | Test Acc: 0.9350
Epoch 87/100 | Train Loss: 0.1660 | Train Acc: 0.9448 | Test Loss: 0.1889 | Test Acc: 0.9375
Epoch 88/100 | Train Loss: 0.1632 | Train Acc: 0.9434 | Test Loss: 0.1852 | Test Acc: 0.9425
Epoch 89/100 | Train Loss: 0.1502 | Train Acc: 0.9526 | Test Loss: 0.1848 | Test Acc: 0.9375
Epoch 90/100 | Train Loss: 0.1598 | Train Acc: 0.9497 | Test Loss: 0.1867 | Test Acc: 0.9375
Epoch 91/100 | Train Loss: 0.1543 | Train Acc: 0.9463 | Test Loss: 0.1869 | Test Acc: 0.9400
Epoch 92/100 | Train Loss: 0.1553 | Train Acc: 0.9458 | Test Loss: 0.1863 | Test Acc: 0.9400
Epoch 93/100 | Train Loss: 0.1588 | Train Acc: 0.9399 | Test Loss: 0.1848 | Test Acc: 0.9375
Epoch 94/100 | Train Loss: 0.1642 | Train Acc: 0.9438 | Test Loss: 0.1846 | Test Acc: 0.9400
Epoch 95/100 | Train Loss: 0.1450 | Train Acc: 0.9531 | Test Loss: 0.1843 | Test Acc: 0.9350
Epoch 96/100 | Train Loss: 0.1594 | Train Acc: 0.9448 | Test Loss: 0.1843 | Test Acc: 0.9375
Epoch 97/100 | Train Loss: 0.1607 | Train Acc: 0.9478 | Test Loss: 0.1839 | Test Acc: 0.9350
Epoch 98/100 | Train Loss: 0.1621 | Train Acc: 0.9473 | Test Loss: 0.1834 | Test Acc: 0.9325
Epoch 99/100 | Train Loss: 0.1604 | Train Acc: 0.9399 | Test Loss: 0.1833 | Test Acc: 0.9325
Epoch 100/100 | Train Loss: 0.1549 | Train Acc: 0.9399 | Test Loss: 0.1833 | Test Acc: 0.9325
Training completed in 674.73 seconds for n_train=2000 (MNIST)
=== Starting training for MNIST: train size 5000, batch size 64, epochs 100 ===

Starting repetition 1/1 for train size 5000, batch size 64 (MNIST)
Total number of parameters in the QViT model for MNIST: 69,111
Epoch 1/100 | Train Loss: 1.3664 | Train Acc: 0.5362 | Test Loss: 0.7597 | Test Acc: 0.7910
Epoch 2/100 | Train Loss: 0.8488 | Train Acc: 0.7172 | Test Loss: 0.5378 | Test Acc: 0.8350
Epoch 3/100 | Train Loss: 0.6747 | Train Acc: 0.7739 | Test Loss: 0.4591 | Test Acc: 0.8480
Epoch 4/100 | Train Loss: 0.5752 | Train Acc: 0.8078 | Test Loss: 0.4145 | Test Acc: 0.8650
Epoch 5/100 | Train Loss: 0.5113 | Train Acc: 0.8279 | Test Loss: 0.3883 | Test Acc: 0.8820
Epoch 6/100 | Train Loss: 0.4796 | Train Acc: 0.8380 | Test Loss: 0.2825 | Test Acc: 0.9080
Epoch 7/100 | Train Loss: 0.4452 | Train Acc: 0.8538 | Test Loss: 0.2994 | Test Acc: 0.9030
Epoch 8/100 | Train Loss: 0.4402 | Train Acc: 0.8536 | Test Loss: 0.2811 | Test Acc: 0.9020
Epoch 9/100 | Train Loss: 0.3998 | Train Acc: 0.8683 | Test Loss: 0.3145 | Test Acc: 0.8930
Epoch 10/100 | Train Loss: 0.3966 | Train Acc: 0.8651 | Test Loss: 0.3605 | Test Acc: 0.8750
Epoch 11/100 | Train Loss: 0.3982 | Train Acc: 0.8677 | Test Loss: 0.2991 | Test Acc: 0.8890
Epoch 12/100 | Train Loss: 0.3670 | Train Acc: 0.8786 | Test Loss: 0.2991 | Test Acc: 0.8980
Epoch 13/100 | Train Loss: 0.3816 | Train Acc: 0.8679 | Test Loss: 0.2971 | Test Acc: 0.8910
Epoch 14/100 | Train Loss: 0.3704 | Train Acc: 0.8831 | Test Loss: 0.2557 | Test Acc: 0.9190
Epoch 15/100 | Train Loss: 0.3579 | Train Acc: 0.8819 | Test Loss: 0.2620 | Test Acc: 0.9090
Epoch 16/100 | Train Loss: 0.3389 | Train Acc: 0.8896 | Test Loss: 0.2550 | Test Acc: 0.9170
Epoch 17/100 | Train Loss: 0.3403 | Train Acc: 0.8869 | Test Loss: 0.2495 | Test Acc: 0.9100
Epoch 18/100 | Train Loss: 0.3351 | Train Acc: 0.8837 | Test Loss: 0.2152 | Test Acc: 0.9240
Epoch 19/100 | Train Loss: 0.3327 | Train Acc: 0.8855 | Test Loss: 0.2368 | Test Acc: 0.9150
Epoch 20/100 | Train Loss: 0.3256 | Train Acc: 0.8900 | Test Loss: 0.2269 | Test Acc: 0.9080
Epoch 21/100 | Train Loss: 0.3242 | Train Acc: 0.8912 | Test Loss: 0.2171 | Test Acc: 0.9200
Epoch 22/100 | Train Loss: 0.3007 | Train Acc: 0.8950 | Test Loss: 0.2705 | Test Acc: 0.9060
Epoch 23/100 | Train Loss: 0.2886 | Train Acc: 0.9049 | Test Loss: 0.2238 | Test Acc: 0.9210
Epoch 24/100 | Train Loss: 0.2869 | Train Acc: 0.9045 | Test Loss: 0.2193 | Test Acc: 0.9160
Epoch 25/100 | Train Loss: 0.2878 | Train Acc: 0.9039 | Test Loss: 0.2474 | Test Acc: 0.9210
Epoch 26/100 | Train Loss: 0.2837 | Train Acc: 0.9041 | Test Loss: 0.2284 | Test Acc: 0.9100
Epoch 27/100 | Train Loss: 0.2984 | Train Acc: 0.8995 | Test Loss: 0.2267 | Test Acc: 0.9160
Epoch 28/100 | Train Loss: 0.2832 | Train Acc: 0.9039 | Test Loss: 0.2074 | Test Acc: 0.9170
Epoch 29/100 | Train Loss: 0.2715 | Train Acc: 0.9090 | Test Loss: 0.1995 | Test Acc: 0.9300
Epoch 30/100 | Train Loss: 0.2785 | Train Acc: 0.9043 | Test Loss: 0.1841 | Test Acc: 0.9270
Epoch 31/100 | Train Loss: 0.2579 | Train Acc: 0.9114 | Test Loss: 0.1921 | Test Acc: 0.9370
Epoch 32/100 | Train Loss: 0.2665 | Train Acc: 0.9126 | Test Loss: 0.2017 | Test Acc: 0.9310
Epoch 33/100 | Train Loss: 0.2614 | Train Acc: 0.9120 | Test Loss: 0.2009 | Test Acc: 0.9230
Epoch 34/100 | Train Loss: 0.2597 | Train Acc: 0.9130 | Test Loss: 0.2236 | Test Acc: 0.9250
Epoch 35/100 | Train Loss: 0.2599 | Train Acc: 0.9108 | Test Loss: 0.2423 | Test Acc: 0.9180
Epoch 36/100 | Train Loss: 0.2555 | Train Acc: 0.9100 | Test Loss: 0.2156 | Test Acc: 0.9220
Epoch 37/100 | Train Loss: 0.2489 | Train Acc: 0.9167 | Test Loss: 0.2438 | Test Acc: 0.9100
Epoch 38/100 | Train Loss: 0.2433 | Train Acc: 0.9169 | Test Loss: 0.2104 | Test Acc: 0.9190
Epoch 39/100 | Train Loss: 0.2436 | Train Acc: 0.9175 | Test Loss: 0.2081 | Test Acc: 0.9320
Epoch 40/100 | Train Loss: 0.2372 | Train Acc: 0.9246 | Test Loss: 0.1988 | Test Acc: 0.9310
Epoch 41/100 | Train Loss: 0.2460 | Train Acc: 0.9161 | Test Loss: 0.1978 | Test Acc: 0.9230
Epoch 42/100 | Train Loss: 0.2485 | Train Acc: 0.9181 | Test Loss: 0.1952 | Test Acc: 0.9330
Epoch 43/100 | Train Loss: 0.2507 | Train Acc: 0.9193 | Test Loss: 0.1910 | Test Acc: 0.9340
Epoch 44/100 | Train Loss: 0.2499 | Train Acc: 0.9144 | Test Loss: 0.1741 | Test Acc: 0.9370
Epoch 45/100 | Train Loss: 0.2164 | Train Acc: 0.9274 | Test Loss: 0.1715 | Test Acc: 0.9410
Epoch 46/100 | Train Loss: 0.2310 | Train Acc: 0.9203 | Test Loss: 0.2201 | Test Acc: 0.9130
Epoch 47/100 | Train Loss: 0.2397 | Train Acc: 0.9173 | Test Loss: 0.1962 | Test Acc: 0.9280
Epoch 48/100 | Train Loss: 0.2304 | Train Acc: 0.9205 | Test Loss: 0.1710 | Test Acc: 0.9420
Epoch 49/100 | Train Loss: 0.2142 | Train Acc: 0.9278 | Test Loss: 0.1862 | Test Acc: 0.9280
Epoch 50/100 | Train Loss: 0.2103 | Train Acc: 0.9290 | Test Loss: 0.1684 | Test Acc: 0.9470
Epoch 51/100 | Train Loss: 0.2370 | Train Acc: 0.9197 | Test Loss: 0.1807 | Test Acc: 0.9360
Epoch 52/100 | Train Loss: 0.2097 | Train Acc: 0.9298 | Test Loss: 0.1782 | Test Acc: 0.9380
Epoch 53/100 | Train Loss: 0.2008 | Train Acc: 0.9339 | Test Loss: 0.1643 | Test Acc: 0.9410
Epoch 54/100 | Train Loss: 0.2181 | Train Acc: 0.9254 | Test Loss: 0.1576 | Test Acc: 0.9370
Epoch 55/100 | Train Loss: 0.1941 | Train Acc: 0.9355 | Test Loss: 0.1621 | Test Acc: 0.9400
Epoch 56/100 | Train Loss: 0.1956 | Train Acc: 0.9345 | Test Loss: 0.1681 | Test Acc: 0.9390
Epoch 57/100 | Train Loss: 0.2010 | Train Acc: 0.9333 | Test Loss: 0.1702 | Test Acc: 0.9330
Epoch 58/100 | Train Loss: 0.2123 | Train Acc: 0.9292 | Test Loss: 0.1692 | Test Acc: 0.9390
Epoch 59/100 | Train Loss: 0.1984 | Train Acc: 0.9288 | Test Loss: 0.1637 | Test Acc: 0.9380
Epoch 60/100 | Train Loss: 0.1945 | Train Acc: 0.9359 | Test Loss: 0.1553 | Test Acc: 0.9460
Epoch 61/100 | Train Loss: 0.1959 | Train Acc: 0.9337 | Test Loss: 0.1578 | Test Acc: 0.9410
Epoch 62/100 | Train Loss: 0.1828 | Train Acc: 0.9355 | Test Loss: 0.1534 | Test Acc: 0.9500
Epoch 63/100 | Train Loss: 0.1920 | Train Acc: 0.9371 | Test Loss: 0.1618 | Test Acc: 0.9420
Epoch 64/100 | Train Loss: 0.1825 | Train Acc: 0.9353 | Test Loss: 0.1580 | Test Acc: 0.9370
Epoch 65/100 | Train Loss: 0.1783 | Train Acc: 0.9403 | Test Loss: 0.1544 | Test Acc: 0.9360
Epoch 66/100 | Train Loss: 0.1718 | Train Acc: 0.9442 | Test Loss: 0.1627 | Test Acc: 0.9390
Epoch 67/100 | Train Loss: 0.1696 | Train Acc: 0.9405 | Test Loss: 0.1593 | Test Acc: 0.9380
Epoch 68/100 | Train Loss: 0.1829 | Train Acc: 0.9389 | Test Loss: 0.1674 | Test Acc: 0.9470
Epoch 69/100 | Train Loss: 0.1780 | Train Acc: 0.9413 | Test Loss: 0.1451 | Test Acc: 0.9430
Epoch 70/100 | Train Loss: 0.1745 | Train Acc: 0.9379 | Test Loss: 0.1466 | Test Acc: 0.9470
Epoch 71/100 | Train Loss: 0.1767 | Train Acc: 0.9373 | Test Loss: 0.1619 | Test Acc: 0.9420
Epoch 72/100 | Train Loss: 0.1692 | Train Acc: 0.9460 | Test Loss: 0.1589 | Test Acc: 0.9420
Epoch 73/100 | Train Loss: 0.1783 | Train Acc: 0.9422 | Test Loss: 0.1532 | Test Acc: 0.9420
Epoch 74/100 | Train Loss: 0.1598 | Train Acc: 0.9470 | Test Loss: 0.1476 | Test Acc: 0.9440
Epoch 75/100 | Train Loss: 0.1557 | Train Acc: 0.9460 | Test Loss: 0.1574 | Test Acc: 0.9350
Epoch 76/100 | Train Loss: 0.1577 | Train Acc: 0.9496 | Test Loss: 0.1510 | Test Acc: 0.9410
Epoch 77/100 | Train Loss: 0.1607 | Train Acc: 0.9450 | Test Loss: 0.1527 | Test Acc: 0.9390
Epoch 78/100 | Train Loss: 0.1625 | Train Acc: 0.9446 | Test Loss: 0.1445 | Test Acc: 0.9450
Epoch 79/100 | Train Loss: 0.1576 | Train Acc: 0.9466 | Test Loss: 0.1527 | Test Acc: 0.9360
Epoch 80/100 | Train Loss: 0.1540 | Train Acc: 0.9462 | Test Loss: 0.1547 | Test Acc: 0.9370
Epoch 81/100 | Train Loss: 0.1633 | Train Acc: 0.9452 | Test Loss: 0.1525 | Test Acc: 0.9400
Epoch 82/100 | Train Loss: 0.1555 | Train Acc: 0.9464 | Test Loss: 0.1456 | Test Acc: 0.9430
Epoch 83/100 | Train Loss: 0.1453 | Train Acc: 0.9551 | Test Loss: 0.1461 | Test Acc: 0.9350
Epoch 84/100 | Train Loss: 0.1513 | Train Acc: 0.9494 | Test Loss: 0.1489 | Test Acc: 0.9390
Epoch 85/100 | Train Loss: 0.1487 | Train Acc: 0.9543 | Test Loss: 0.1458 | Test Acc: 0.9400
Epoch 86/100 | Train Loss: 0.1450 | Train Acc: 0.9531 | Test Loss: 0.1495 | Test Acc: 0.9400
Epoch 87/100 | Train Loss: 0.1476 | Train Acc: 0.9533 | Test Loss: 0.1500 | Test Acc: 0.9400
Epoch 88/100 | Train Loss: 0.1468 | Train Acc: 0.9517 | Test Loss: 0.1491 | Test Acc: 0.9400
Epoch 89/100 | Train Loss: 0.1471 | Train Acc: 0.9506 | Test Loss: 0.1486 | Test Acc: 0.9380
Epoch 90/100 | Train Loss: 0.1471 | Train Acc: 0.9498 | Test Loss: 0.1459 | Test Acc: 0.9420
Epoch 91/100 | Train Loss: 0.1518 | Train Acc: 0.9519 | Test Loss: 0.1461 | Test Acc: 0.9420
Epoch 92/100 | Train Loss: 0.1561 | Train Acc: 0.9494 | Test Loss: 0.1472 | Test Acc: 0.9420
Epoch 93/100 | Train Loss: 0.1542 | Train Acc: 0.9508 | Test Loss: 0.1475 | Test Acc: 0.9390
Epoch 94/100 | Train Loss: 0.1533 | Train Acc: 0.9470 | Test Loss: 0.1473 | Test Acc: 0.9390
Epoch 95/100 | Train Loss: 0.1549 | Train Acc: 0.9496 | Test Loss: 0.1471 | Test Acc: 0.9390
Epoch 96/100 | Train Loss: 0.1540 | Train Acc: 0.9513 | Test Loss: 0.1470 | Test Acc: 0.9380
Epoch 97/100 | Train Loss: 0.1369 | Train Acc: 0.9529 | Test Loss: 0.1467 | Test Acc: 0.9380
Epoch 98/100 | Train Loss: 0.1420 | Train Acc: 0.9567 | Test Loss: 0.1467 | Test Acc: 0.9390
Epoch 99/100 | Train Loss: 0.1368 | Train Acc: 0.9547 | Test Loss: 0.1466 | Test Acc: 0.9400
Epoch 100/100 | Train Loss: 0.1371 | Train Acc: 0.9567 | Test Loss: 0.1466 | Test Acc: 0.9400
Training completed in 1609.88 seconds for n_train=5000 (MNIST)
=== Starting training for MNIST: train size 10000, batch size 64, epochs 100 ===

Starting repetition 1/1 for train size 10000, batch size 64 (MNIST)
Total number of parameters in the QViT model for MNIST: 69,111
Epoch 1/100 | Train Loss: 1.0715 | Train Acc: 0.6380 | Test Loss: 0.4924 | Test Acc: 0.8420
Epoch 2/100 | Train Loss: 0.6057 | Train Acc: 0.7936 | Test Loss: 0.3677 | Test Acc: 0.8775
Epoch 3/100 | Train Loss: 0.4918 | Train Acc: 0.8339 | Test Loss: 0.2905 | Test Acc: 0.9075
Epoch 4/100 | Train Loss: 0.4524 | Train Acc: 0.8460 | Test Loss: 0.2792 | Test Acc: 0.9025
Epoch 5/100 | Train Loss: 0.4071 | Train Acc: 0.8586 | Test Loss: 0.2513 | Test Acc: 0.9200
Epoch 6/100 | Train Loss: 0.3757 | Train Acc: 0.8716 | Test Loss: 0.2302 | Test Acc: 0.9270
Epoch 7/100 | Train Loss: 0.3476 | Train Acc: 0.8843 | Test Loss: 0.2109 | Test Acc: 0.9350
Epoch 8/100 | Train Loss: 0.3453 | Train Acc: 0.8840 | Test Loss: 0.2122 | Test Acc: 0.9350
Epoch 9/100 | Train Loss: 0.3283 | Train Acc: 0.8891 | Test Loss: 0.1987 | Test Acc: 0.9395
Epoch 10/100 | Train Loss: 0.3221 | Train Acc: 0.8960 | Test Loss: 0.2147 | Test Acc: 0.9325
Epoch 11/100 | Train Loss: 0.3233 | Train Acc: 0.8912 | Test Loss: 0.2181 | Test Acc: 0.9280
Epoch 12/100 | Train Loss: 0.3017 | Train Acc: 0.8990 | Test Loss: 0.2328 | Test Acc: 0.9290
Epoch 13/100 | Train Loss: 0.2952 | Train Acc: 0.9008 | Test Loss: 0.1967 | Test Acc: 0.9380
Epoch 14/100 | Train Loss: 0.2853 | Train Acc: 0.9020 | Test Loss: 0.2203 | Test Acc: 0.9280
Epoch 15/100 | Train Loss: 0.2857 | Train Acc: 0.9070 | Test Loss: 0.2087 | Test Acc: 0.9250
Epoch 16/100 | Train Loss: 0.2886 | Train Acc: 0.9010 | Test Loss: 0.2036 | Test Acc: 0.9275
Epoch 17/100 | Train Loss: 0.2736 | Train Acc: 0.9067 | Test Loss: 0.1711 | Test Acc: 0.9450
Epoch 18/100 | Train Loss: 0.2661 | Train Acc: 0.9124 | Test Loss: 0.1834 | Test Acc: 0.9385
Epoch 19/100 | Train Loss: 0.2594 | Train Acc: 0.9146 | Test Loss: 0.1631 | Test Acc: 0.9450
Epoch 20/100 | Train Loss: 0.2602 | Train Acc: 0.9111 | Test Loss: 0.2000 | Test Acc: 0.9300
Epoch 21/100 | Train Loss: 0.2625 | Train Acc: 0.9121 | Test Loss: 0.2120 | Test Acc: 0.9300
Epoch 22/100 | Train Loss: 0.2503 | Train Acc: 0.9167 | Test Loss: 0.1835 | Test Acc: 0.9370
Epoch 23/100 | Train Loss: 0.2473 | Train Acc: 0.9187 | Test Loss: 0.1804 | Test Acc: 0.9400
Epoch 24/100 | Train Loss: 0.2467 | Train Acc: 0.9165 | Test Loss: 0.1622 | Test Acc: 0.9470
Epoch 25/100 | Train Loss: 0.2433 | Train Acc: 0.9192 | Test Loss: 0.1516 | Test Acc: 0.9475
Epoch 26/100 | Train Loss: 0.2427 | Train Acc: 0.9195 | Test Loss: 0.1559 | Test Acc: 0.9530
Epoch 27/100 | Train Loss: 0.2330 | Train Acc: 0.9200 | Test Loss: 0.1677 | Test Acc: 0.9480
Epoch 28/100 | Train Loss: 0.2393 | Train Acc: 0.9211 | Test Loss: 0.2114 | Test Acc: 0.9320
Epoch 29/100 | Train Loss: 0.2259 | Train Acc: 0.9260 | Test Loss: 0.1565 | Test Acc: 0.9505
Epoch 30/100 | Train Loss: 0.2368 | Train Acc: 0.9244 | Test Loss: 0.1717 | Test Acc: 0.9440
Epoch 31/100 | Train Loss: 0.2312 | Train Acc: 0.9209 | Test Loss: 0.1622 | Test Acc: 0.9515
Epoch 32/100 | Train Loss: 0.2298 | Train Acc: 0.9246 | Test Loss: 0.1618 | Test Acc: 0.9530
Epoch 33/100 | Train Loss: 0.2121 | Train Acc: 0.9305 | Test Loss: 0.1724 | Test Acc: 0.9375
Epoch 34/100 | Train Loss: 0.2158 | Train Acc: 0.9274 | Test Loss: 0.1938 | Test Acc: 0.9320
Epoch 35/100 | Train Loss: 0.2047 | Train Acc: 0.9297 | Test Loss: 0.1653 | Test Acc: 0.9470
Epoch 36/100 | Train Loss: 0.2106 | Train Acc: 0.9295 | Test Loss: 0.1607 | Test Acc: 0.9465
Epoch 37/100 | Train Loss: 0.2084 | Train Acc: 0.9283 | Test Loss: 0.1546 | Test Acc: 0.9510
Epoch 38/100 | Train Loss: 0.2034 | Train Acc: 0.9328 | Test Loss: 0.1630 | Test Acc: 0.9425
Epoch 39/100 | Train Loss: 0.2031 | Train Acc: 0.9301 | Test Loss: 0.1759 | Test Acc: 0.9360
Epoch 40/100 | Train Loss: 0.2083 | Train Acc: 0.9312 | Test Loss: 0.1291 | Test Acc: 0.9615
Epoch 41/100 | Train Loss: 0.2070 | Train Acc: 0.9313 | Test Loss: 0.1530 | Test Acc: 0.9475
Epoch 42/100 | Train Loss: 0.2014 | Train Acc: 0.9332 | Test Loss: 0.1581 | Test Acc: 0.9525
Epoch 43/100 | Train Loss: 0.1942 | Train Acc: 0.9336 | Test Loss: 0.1529 | Test Acc: 0.9505
Epoch 44/100 | Train Loss: 0.1871 | Train Acc: 0.9384 | Test Loss: 0.1458 | Test Acc: 0.9510
Epoch 45/100 | Train Loss: 0.1912 | Train Acc: 0.9360 | Test Loss: 0.1713 | Test Acc: 0.9435
Epoch 46/100 | Train Loss: 0.1879 | Train Acc: 0.9367 | Test Loss: 0.1739 | Test Acc: 0.9385
Epoch 47/100 | Train Loss: 0.1852 | Train Acc: 0.9354 | Test Loss: 0.1650 | Test Acc: 0.9445
Epoch 48/100 | Train Loss: 0.1777 | Train Acc: 0.9406 | Test Loss: 0.1460 | Test Acc: 0.9535
Epoch 49/100 | Train Loss: 0.1879 | Train Acc: 0.9368 | Test Loss: 0.1373 | Test Acc: 0.9575
Epoch 50/100 | Train Loss: 0.1698 | Train Acc: 0.9432 | Test Loss: 0.1418 | Test Acc: 0.9535
Epoch 51/100 | Train Loss: 0.1740 | Train Acc: 0.9426 | Test Loss: 0.1378 | Test Acc: 0.9570
Epoch 52/100 | Train Loss: 0.1782 | Train Acc: 0.9383 | Test Loss: 0.1442 | Test Acc: 0.9545
Epoch 53/100 | Train Loss: 0.1750 | Train Acc: 0.9403 | Test Loss: 0.1283 | Test Acc: 0.9585
Epoch 54/100 | Train Loss: 0.1645 | Train Acc: 0.9427 | Test Loss: 0.1491 | Test Acc: 0.9495
Epoch 55/100 | Train Loss: 0.1672 | Train Acc: 0.9432 | Test Loss: 0.1293 | Test Acc: 0.9640
Epoch 56/100 | Train Loss: 0.1755 | Train Acc: 0.9389 | Test Loss: 0.1466 | Test Acc: 0.9515
Epoch 57/100 | Train Loss: 0.1658 | Train Acc: 0.9428 | Test Loss: 0.1327 | Test Acc: 0.9550
Epoch 58/100 | Train Loss: 0.1701 | Train Acc: 0.9415 | Test Loss: 0.1210 | Test Acc: 0.9580
Epoch 59/100 | Train Loss: 0.1657 | Train Acc: 0.9445 | Test Loss: 0.1296 | Test Acc: 0.9575
Epoch 60/100 | Train Loss: 0.1623 | Train Acc: 0.9446 | Test Loss: 0.1242 | Test Acc: 0.9605
Epoch 61/100 | Train Loss: 0.1534 | Train Acc: 0.9478 | Test Loss: 0.1246 | Test Acc: 0.9595
Epoch 62/100 | Train Loss: 0.1610 | Train Acc: 0.9437 | Test Loss: 0.1262 | Test Acc: 0.9620
Epoch 63/100 | Train Loss: 0.1601 | Train Acc: 0.9462 | Test Loss: 0.1303 | Test Acc: 0.9640
Epoch 64/100 | Train Loss: 0.1539 | Train Acc: 0.9471 | Test Loss: 0.1194 | Test Acc: 0.9630
Epoch 65/100 | Train Loss: 0.1558 | Train Acc: 0.9475 | Test Loss: 0.1230 | Test Acc: 0.9605
Epoch 66/100 | Train Loss: 0.1496 | Train Acc: 0.9507 | Test Loss: 0.1198 | Test Acc: 0.9675
Epoch 67/100 | Train Loss: 0.1441 | Train Acc: 0.9515 | Test Loss: 0.1267 | Test Acc: 0.9615
Epoch 68/100 | Train Loss: 0.1436 | Train Acc: 0.9508 | Test Loss: 0.1157 | Test Acc: 0.9620
Epoch 69/100 | Train Loss: 0.1513 | Train Acc: 0.9494 | Test Loss: 0.1205 | Test Acc: 0.9620
Epoch 70/100 | Train Loss: 0.1471 | Train Acc: 0.9517 | Test Loss: 0.1116 | Test Acc: 0.9680
Epoch 71/100 | Train Loss: 0.1407 | Train Acc: 0.9551 | Test Loss: 0.1157 | Test Acc: 0.9650
Epoch 72/100 | Train Loss: 0.1374 | Train Acc: 0.9537 | Test Loss: 0.1225 | Test Acc: 0.9630
Epoch 73/100 | Train Loss: 0.1465 | Train Acc: 0.9518 | Test Loss: 0.1304 | Test Acc: 0.9610
Epoch 74/100 | Train Loss: 0.1395 | Train Acc: 0.9558 | Test Loss: 0.1149 | Test Acc: 0.9610
Epoch 75/100 | Train Loss: 0.1394 | Train Acc: 0.9541 | Test Loss: 0.1216 | Test Acc: 0.9570
Epoch 76/100 | Train Loss: 0.1410 | Train Acc: 0.9522 | Test Loss: 0.1144 | Test Acc: 0.9630
Epoch 77/100 | Train Loss: 0.1287 | Train Acc: 0.9587 | Test Loss: 0.1193 | Test Acc: 0.9615
Epoch 78/100 | Train Loss: 0.1299 | Train Acc: 0.9541 | Test Loss: 0.1190 | Test Acc: 0.9610
Epoch 79/100 | Train Loss: 0.1374 | Train Acc: 0.9552 | Test Loss: 0.1191 | Test Acc: 0.9610
Epoch 80/100 | Train Loss: 0.1315 | Train Acc: 0.9561 | Test Loss: 0.1141 | Test Acc: 0.9635
Epoch 81/100 | Train Loss: 0.1334 | Train Acc: 0.9545 | Test Loss: 0.1139 | Test Acc: 0.9650
Epoch 82/100 | Train Loss: 0.1294 | Train Acc: 0.9564 | Test Loss: 0.1164 | Test Acc: 0.9650
Epoch 83/100 | Train Loss: 0.1304 | Train Acc: 0.9578 | Test Loss: 0.1174 | Test Acc: 0.9640
Epoch 84/100 | Train Loss: 0.1317 | Train Acc: 0.9567 | Test Loss: 0.1217 | Test Acc: 0.9615
Epoch 85/100 | Train Loss: 0.1282 | Train Acc: 0.9559 | Test Loss: 0.1183 | Test Acc: 0.9620
Epoch 86/100 | Train Loss: 0.1240 | Train Acc: 0.9582 | Test Loss: 0.1126 | Test Acc: 0.9630
Epoch 87/100 | Train Loss: 0.1305 | Train Acc: 0.9571 | Test Loss: 0.1106 | Test Acc: 0.9640
Epoch 88/100 | Train Loss: 0.1302 | Train Acc: 0.9561 | Test Loss: 0.1152 | Test Acc: 0.9610
Epoch 89/100 | Train Loss: 0.1261 | Train Acc: 0.9580 | Test Loss: 0.1109 | Test Acc: 0.9645
Epoch 90/100 | Train Loss: 0.1297 | Train Acc: 0.9560 | Test Loss: 0.1098 | Test Acc: 0.9650
Epoch 91/100 | Train Loss: 0.1202 | Train Acc: 0.9634 | Test Loss: 0.1110 | Test Acc: 0.9635
Epoch 92/100 | Train Loss: 0.1251 | Train Acc: 0.9576 | Test Loss: 0.1109 | Test Acc: 0.9630
Epoch 93/100 | Train Loss: 0.1278 | Train Acc: 0.9561 | Test Loss: 0.1107 | Test Acc: 0.9645
Epoch 94/100 | Train Loss: 0.1271 | Train Acc: 0.9588 | Test Loss: 0.1110 | Test Acc: 0.9635
Epoch 95/100 | Train Loss: 0.1266 | Train Acc: 0.9589 | Test Loss: 0.1103 | Test Acc: 0.9640
Epoch 96/100 | Train Loss: 0.1215 | Train Acc: 0.9589 | Test Loss: 0.1104 | Test Acc: 0.9635
Epoch 97/100 | Train Loss: 0.1254 | Train Acc: 0.9590 | Test Loss: 0.1103 | Test Acc: 0.9640
Epoch 98/100 | Train Loss: 0.1208 | Train Acc: 0.9596 | Test Loss: 0.1100 | Test Acc: 0.9640
Epoch 99/100 | Train Loss: 0.1235 | Train Acc: 0.9592 | Test Loss: 0.1101 | Test Acc: 0.9640
Epoch 100/100 | Train Loss: 0.1287 | Train Acc: 0.9571 | Test Loss: 0.1101 | Test Acc: 0.9640
Training completed in 3236.13 seconds for n_train=10000 (MNIST)
=== Starting training for MNIST: train size 20000, batch size 64, epochs 100 ===

Starting repetition 1/1 for train size 20000, batch size 64 (MNIST)
Total number of parameters in the QViT model for MNIST: 69,111
Epoch 1/100 | Train Loss: 0.8398 | Train Acc: 0.7170 | Test Loss: 0.3334 | Test Acc: 0.8968
Epoch 2/100 | Train Loss: 0.4650 | Train Acc: 0.8429 | Test Loss: 0.2906 | Test Acc: 0.8993
Epoch 3/100 | Train Loss: 0.4011 | Train Acc: 0.8645 | Test Loss: 0.2232 | Test Acc: 0.9248
Epoch 4/100 | Train Loss: 0.3599 | Train Acc: 0.8790 | Test Loss: 0.2201 | Test Acc: 0.9283
Epoch 5/100 | Train Loss: 0.3323 | Train Acc: 0.8885 | Test Loss: 0.3046 | Test Acc: 0.8935
Epoch 6/100 | Train Loss: 0.3170 | Train Acc: 0.8942 | Test Loss: 0.2314 | Test Acc: 0.9243
Epoch 7/100 | Train Loss: 0.3046 | Train Acc: 0.8979 | Test Loss: 0.1988 | Test Acc: 0.9333
Epoch 8/100 | Train Loss: 0.2982 | Train Acc: 0.8992 | Test Loss: 0.1899 | Test Acc: 0.9398
Epoch 9/100 | Train Loss: 0.2730 | Train Acc: 0.9062 | Test Loss: 0.2094 | Test Acc: 0.9290
Epoch 10/100 | Train Loss: 0.2793 | Train Acc: 0.9073 | Test Loss: 0.1806 | Test Acc: 0.9403
Epoch 11/100 | Train Loss: 0.2706 | Train Acc: 0.9107 | Test Loss: 0.2011 | Test Acc: 0.9320
Epoch 12/100 | Train Loss: 0.2571 | Train Acc: 0.9171 | Test Loss: 0.1584 | Test Acc: 0.9483
Epoch 13/100 | Train Loss: 0.2466 | Train Acc: 0.9164 | Test Loss: 0.1577 | Test Acc: 0.9495
Epoch 14/100 | Train Loss: 0.2486 | Train Acc: 0.9181 | Test Loss: 0.2294 | Test Acc: 0.9245
Epoch 15/100 | Train Loss: 0.2456 | Train Acc: 0.9195 | Test Loss: 0.1903 | Test Acc: 0.9298
Epoch 16/100 | Train Loss: 0.2351 | Train Acc: 0.9222 | Test Loss: 0.1868 | Test Acc: 0.9348
Epoch 17/100 | Train Loss: 0.2339 | Train Acc: 0.9209 | Test Loss: 0.1691 | Test Acc: 0.9443
Epoch 18/100 | Train Loss: 0.2293 | Train Acc: 0.9219 | Test Loss: 0.1713 | Test Acc: 0.9445
Epoch 19/100 | Train Loss: 0.2235 | Train Acc: 0.9261 | Test Loss: 0.2050 | Test Acc: 0.9315
Epoch 20/100 | Train Loss: 0.2167 | Train Acc: 0.9290 | Test Loss: 0.1535 | Test Acc: 0.9485
Epoch 21/100 | Train Loss: 0.2190 | Train Acc: 0.9274 | Test Loss: 0.1772 | Test Acc: 0.9380
Epoch 22/100 | Train Loss: 0.2160 | Train Acc: 0.9270 | Test Loss: 0.1578 | Test Acc: 0.9455
Epoch 23/100 | Train Loss: 0.2194 | Train Acc: 0.9275 | Test Loss: 0.1566 | Test Acc: 0.9460
Epoch 24/100 | Train Loss: 0.2064 | Train Acc: 0.9313 | Test Loss: 0.1679 | Test Acc: 0.9428
Epoch 25/100 | Train Loss: 0.2025 | Train Acc: 0.9326 | Test Loss: 0.1659 | Test Acc: 0.9435
Epoch 26/100 | Train Loss: 0.2037 | Train Acc: 0.9345 | Test Loss: 0.1474 | Test Acc: 0.9510
Epoch 27/100 | Train Loss: 0.2019 | Train Acc: 0.9310 | Test Loss: 0.1532 | Test Acc: 0.9513
Epoch 28/100 | Train Loss: 0.2004 | Train Acc: 0.9314 | Test Loss: 0.1388 | Test Acc: 0.9535
Epoch 29/100 | Train Loss: 0.1948 | Train Acc: 0.9334 | Test Loss: 0.1504 | Test Acc: 0.9473
Epoch 30/100 | Train Loss: 0.1935 | Train Acc: 0.9352 | Test Loss: 0.1557 | Test Acc: 0.9460
Epoch 31/100 | Train Loss: 0.1916 | Train Acc: 0.9379 | Test Loss: 0.1603 | Test Acc: 0.9440
Epoch 32/100 | Train Loss: 0.1849 | Train Acc: 0.9379 | Test Loss: 0.1675 | Test Acc: 0.9428
Epoch 33/100 | Train Loss: 0.1860 | Train Acc: 0.9379 | Test Loss: 0.1423 | Test Acc: 0.9490
Epoch 34/100 | Train Loss: 0.1870 | Train Acc: 0.9384 | Test Loss: 0.1354 | Test Acc: 0.9578
Epoch 35/100 | Train Loss: 0.1749 | Train Acc: 0.9420 | Test Loss: 0.1458 | Test Acc: 0.9520
Epoch 36/100 | Train Loss: 0.1757 | Train Acc: 0.9428 | Test Loss: 0.1320 | Test Acc: 0.9568
Epoch 37/100 | Train Loss: 0.1726 | Train Acc: 0.9428 | Test Loss: 0.1388 | Test Acc: 0.9505
Epoch 38/100 | Train Loss: 0.1747 | Train Acc: 0.9411 | Test Loss: 0.1398 | Test Acc: 0.9523
Epoch 39/100 | Train Loss: 0.1661 | Train Acc: 0.9455 | Test Loss: 0.1319 | Test Acc: 0.9590
Epoch 40/100 | Train Loss: 0.1677 | Train Acc: 0.9436 | Test Loss: 0.1342 | Test Acc: 0.9588
Epoch 41/100 | Train Loss: 0.1664 | Train Acc: 0.9466 | Test Loss: 0.1328 | Test Acc: 0.9580
Epoch 42/100 | Train Loss: 0.1718 | Train Acc: 0.9430 | Test Loss: 0.1326 | Test Acc: 0.9578
Epoch 43/100 | Train Loss: 0.1678 | Train Acc: 0.9446 | Test Loss: 0.1267 | Test Acc: 0.9613
Epoch 44/100 | Train Loss: 0.1609 | Train Acc: 0.9468 | Test Loss: 0.1216 | Test Acc: 0.9615
Epoch 45/100 | Train Loss: 0.1574 | Train Acc: 0.9474 | Test Loss: 0.1239 | Test Acc: 0.9575
Epoch 46/100 | Train Loss: 0.1568 | Train Acc: 0.9474 | Test Loss: 0.1472 | Test Acc: 0.9485
Epoch 47/100 | Train Loss: 0.1562 | Train Acc: 0.9484 | Test Loss: 0.1139 | Test Acc: 0.9613
Epoch 48/100 | Train Loss: 0.1560 | Train Acc: 0.9473 | Test Loss: 0.1247 | Test Acc: 0.9565
Epoch 49/100 | Train Loss: 0.1564 | Train Acc: 0.9473 | Test Loss: 0.1149 | Test Acc: 0.9628
Epoch 50/100 | Train Loss: 0.1516 | Train Acc: 0.9496 | Test Loss: 0.1121 | Test Acc: 0.9623
Epoch 51/100 | Train Loss: 0.1473 | Train Acc: 0.9521 | Test Loss: 0.1286 | Test Acc: 0.9550
Epoch 52/100 | Train Loss: 0.1500 | Train Acc: 0.9485 | Test Loss: 0.1475 | Test Acc: 0.9523
Epoch 53/100 | Train Loss: 0.1442 | Train Acc: 0.9534 | Test Loss: 0.1228 | Test Acc: 0.9565
Epoch 54/100 | Train Loss: 0.1469 | Train Acc: 0.9513 | Test Loss: 0.1147 | Test Acc: 0.9610
Epoch 55/100 | Train Loss: 0.1378 | Train Acc: 0.9539 | Test Loss: 0.1088 | Test Acc: 0.9653
Epoch 56/100 | Train Loss: 0.1425 | Train Acc: 0.9521 | Test Loss: 0.1190 | Test Acc: 0.9583
Epoch 57/100 | Train Loss: 0.1372 | Train Acc: 0.9534 | Test Loss: 0.1126 | Test Acc: 0.9610
Epoch 58/100 | Train Loss: 0.1408 | Train Acc: 0.9522 | Test Loss: 0.1141 | Test Acc: 0.9628
Epoch 59/100 | Train Loss: 0.1331 | Train Acc: 0.9563 | Test Loss: 0.1214 | Test Acc: 0.9610
Epoch 60/100 | Train Loss: 0.1342 | Train Acc: 0.9542 | Test Loss: 0.1196 | Test Acc: 0.9585
Epoch 61/100 | Train Loss: 0.1322 | Train Acc: 0.9577 | Test Loss: 0.1125 | Test Acc: 0.9605
Epoch 62/100 | Train Loss: 0.1314 | Train Acc: 0.9566 | Test Loss: 0.1165 | Test Acc: 0.9598
Epoch 63/100 | Train Loss: 0.1327 | Train Acc: 0.9582 | Test Loss: 0.1166 | Test Acc: 0.9623
Epoch 64/100 | Train Loss: 0.1306 | Train Acc: 0.9569 | Test Loss: 0.1125 | Test Acc: 0.9620
Epoch 65/100 | Train Loss: 0.1217 | Train Acc: 0.9593 | Test Loss: 0.1198 | Test Acc: 0.9600
Epoch 66/100 | Train Loss: 0.1255 | Train Acc: 0.9582 | Test Loss: 0.1122 | Test Acc: 0.9623
Epoch 67/100 | Train Loss: 0.1295 | Train Acc: 0.9575 | Test Loss: 0.1134 | Test Acc: 0.9618
Epoch 68/100 | Train Loss: 0.1224 | Train Acc: 0.9601 | Test Loss: 0.1065 | Test Acc: 0.9648
Epoch 69/100 | Train Loss: 0.1264 | Train Acc: 0.9576 | Test Loss: 0.1041 | Test Acc: 0.9663
Epoch 70/100 | Train Loss: 0.1206 | Train Acc: 0.9612 | Test Loss: 0.1016 | Test Acc: 0.9668
Epoch 71/100 | Train Loss: 0.1215 | Train Acc: 0.9602 | Test Loss: 0.1079 | Test Acc: 0.9653
Epoch 72/100 | Train Loss: 0.1208 | Train Acc: 0.9604 | Test Loss: 0.1032 | Test Acc: 0.9673
Epoch 73/100 | Train Loss: 0.1170 | Train Acc: 0.9612 | Test Loss: 0.1139 | Test Acc: 0.9620
Epoch 74/100 | Train Loss: 0.1175 | Train Acc: 0.9612 | Test Loss: 0.1016 | Test Acc: 0.9665
Epoch 75/100 | Train Loss: 0.1171 | Train Acc: 0.9610 | Test Loss: 0.1134 | Test Acc: 0.9630
Epoch 76/100 | Train Loss: 0.1208 | Train Acc: 0.9588 | Test Loss: 0.1104 | Test Acc: 0.9638
Epoch 77/100 | Train Loss: 0.1148 | Train Acc: 0.9628 | Test Loss: 0.1068 | Test Acc: 0.9653
Epoch 78/100 | Train Loss: 0.1149 | Train Acc: 0.9616 | Test Loss: 0.1070 | Test Acc: 0.9673
Epoch 79/100 | Train Loss: 0.1102 | Train Acc: 0.9644 | Test Loss: 0.1042 | Test Acc: 0.9660
Epoch 80/100 | Train Loss: 0.1100 | Train Acc: 0.9641 | Test Loss: 0.1058 | Test Acc: 0.9658
Epoch 81/100 | Train Loss: 0.1093 | Train Acc: 0.9642 | Test Loss: 0.1046 | Test Acc: 0.9648
Epoch 82/100 | Train Loss: 0.1105 | Train Acc: 0.9636 | Test Loss: 0.1063 | Test Acc: 0.9645
Epoch 83/100 | Train Loss: 0.1078 | Train Acc: 0.9638 | Test Loss: 0.1044 | Test Acc: 0.9658
Epoch 84/100 | Train Loss: 0.1078 | Train Acc: 0.9651 | Test Loss: 0.1041 | Test Acc: 0.9660
Epoch 85/100 | Train Loss: 0.1089 | Train Acc: 0.9638 | Test Loss: 0.1034 | Test Acc: 0.9670
Epoch 86/100 | Train Loss: 0.1087 | Train Acc: 0.9650 | Test Loss: 0.1018 | Test Acc: 0.9660
Epoch 87/100 | Train Loss: 0.1056 | Train Acc: 0.9642 | Test Loss: 0.1020 | Test Acc: 0.9665
Epoch 88/100 | Train Loss: 0.1073 | Train Acc: 0.9644 | Test Loss: 0.1012 | Test Acc: 0.9670
Epoch 89/100 | Train Loss: 0.1065 | Train Acc: 0.9654 | Test Loss: 0.1016 | Test Acc: 0.9665
Epoch 90/100 | Train Loss: 0.1066 | Train Acc: 0.9644 | Test Loss: 0.0978 | Test Acc: 0.9680
Epoch 91/100 | Train Loss: 0.1073 | Train Acc: 0.9637 | Test Loss: 0.0994 | Test Acc: 0.9678
Epoch 92/100 | Train Loss: 0.1075 | Train Acc: 0.9645 | Test Loss: 0.1001 | Test Acc: 0.9678
Epoch 93/100 | Train Loss: 0.1039 | Train Acc: 0.9653 | Test Loss: 0.1020 | Test Acc: 0.9663
Epoch 94/100 | Train Loss: 0.1079 | Train Acc: 0.9646 | Test Loss: 0.1023 | Test Acc: 0.9658
Epoch 95/100 | Train Loss: 0.1043 | Train Acc: 0.9649 | Test Loss: 0.1029 | Test Acc: 0.9658
Epoch 96/100 | Train Loss: 0.1040 | Train Acc: 0.9656 | Test Loss: 0.1018 | Test Acc: 0.9668
Epoch 97/100 | Train Loss: 0.1059 | Train Acc: 0.9642 | Test Loss: 0.1018 | Test Acc: 0.9663
Epoch 98/100 | Train Loss: 0.1054 | Train Acc: 0.9645 | Test Loss: 0.1021 | Test Acc: 0.9665
Epoch 99/100 | Train Loss: 0.1037 | Train Acc: 0.9644 | Test Loss: 0.1020 | Test Acc: 0.9665
Epoch 100/100 | Train Loss: 0.1052 | Train Acc: 0.9658 | Test Loss: 0.1020 | Test Acc: 0.9663
"""  # Truncated for brevity; paste full content here

# Pattern to extract metrics
pattern = r"Epoch (\d+)/\d+ \| Train Loss: ([\d.]+) \| Train Acc: ([\d.]+) \| Test Loss: ([\d.]+) \| Test Acc: ([\d.]+)"

# Parse the log
matches = re.findall(pattern, training_log)

# Create a CSV file
with open("training_metrics.csv", mode="w", newline="") as file:
    writer = csv.writer(file)
    writer.writerow(["Epoch", "Train Loss", "Train Accuracy", "Test Loss", "Test Accuracy"])
    for match in matches:
        epoch, train_loss, train_acc, test_loss, test_acc = match
        writer.writerow([int(epoch), float(train_loss), float(train_acc), float(test_loss), float(test_acc)])

print("✅ Metrics successfully saved to 'training_metrics.csv'.")
